<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æƒé™¤å½“ç•ªãã˜å¼•ã</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', 'Yu Gothic', YuGothic, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 40px 20px;
            background-attachment: fixed;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            box-shadow: 0 30px 90px rgba(0, 0, 0, 0.15);
            padding: 50px;
            border: 1px solid rgba(255, 255, 255, 0.8);
        }

        h1 {
            text-align: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 40px;
            font-size: 2.5em;
            font-weight: 800;
            letter-spacing: -0.02em;
        }

        .input-section {
            background: linear-gradient(135deg, #f8f9ff 0%, #f0f2ff 100%);
            padding: 35px;
            border-radius: 20px;
            margin-bottom: 35px;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .gender-group {
            margin-bottom: 28px;
        }

        .gender-group:last-child {
            margin-bottom: 0;
        }

        .gender-group h3 {
            color: #2d3748;
            margin-bottom: 16px;
            font-size: 1em;
            font-weight: 600;
            letter-spacing: 0.02em;
            text-transform: uppercase;
            opacity: 0.8;
        }

        .name-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 12px;
        }

        input[type="text"] {
            padding: 14px 18px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 0.95em;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: white;
            color: #2d3748;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-1px);
        }

        input[type="text"]::placeholder {
            color: #a0aec0;
        }

        .button-container {
            text-align: center;
            margin: 35px 0;
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 16px 32px;
            font-size: 1em;
            font-weight: 600;
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            letter-spacing: 0.02em;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .results {
            display: none;
        }

        .results.show {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result-item {
            background: white;
            border: 1px solid #e2e8f0;
            padding: 24px;
            margin-bottom: 16px;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .result-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .result-item:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
        }

        .duty-name {
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 1.15em;
            margin-bottom: 10px;
            letter-spacing: -0.01em;
        }

        .assigned-person {
            color: #4a5568;
            font-size: 1em;
            padding-left: 8px;
            font-weight: 500;
        }

        .error {
            background: linear-gradient(135deg, #fff5f5 0%, #fed7d7 100%);
            border: 1px solid #fc8181;
            color: #742a2a;
            padding: 16px 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 500;
        }

        .info {
            background: linear-gradient(135deg, #ebf8ff 0%, #bee3f8 100%);
            border: 1px solid #90cdf4;
            padding: 16px 20px;
            margin-bottom: 24px;
            border-radius: 12px;
            font-size: 0.9em;
            color: #2c5282;
            font-weight: 500;
        }

        .lottery-animation {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: #000000;
            z-index: 9999;
            overflow: hidden;
        }

        .lottery-animation.active {
            display: block;
        }

        .lottery-animation.reveal-space {
            background: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);
            transition: background 1.5s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }

        .stars {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
        }

        .stars.appear {
            animation: starsAppear 2s ease-in forwards;
        }

        @keyframes starsAppear {
            0% {
                opacity: 0;
            }
            100% {
                opacity: 1;
            }
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        .shooting-star {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, #fff, transparent);
            box-shadow: 0 0 10px 2px rgba(255, 255, 255, 0.8);
            opacity: 0;
        }

        .shooting-star.shoot {
            animation: shoot 1.5s ease-out forwards;
        }

        @keyframes shoot {
            0% {
                transform: translateX(0) translateY(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            100% {
                transform: translateX(1000px) translateY(500px);
                opacity: 0;
            }
        }

        .big-shooting-star {
            position: absolute;
            height: 4px;
            background: linear-gradient(90deg, #fff 0%, #667eea 50%, transparent);
            box-shadow: 0 0 20px 4px rgba(255, 255, 255, 1),
                        0 0 40px 8px rgba(102, 126, 234, 0.8);
            opacity: 0;
        }

        .big-shooting-star.shoot {
            animation: bigShoot 2s ease-out forwards;
        }

        @keyframes bigShoot {
            0% {
                transform: translateX(0) translateY(0) scale(1);
                opacity: 0;
            }
            5% {
                opacity: 1;
            }
            100% {
                transform: translateX(1500px) translateY(800px) scale(1.5);
                opacity: 0;
            }
        }

        .center-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 10;
            opacity: 0;
        }

        .center-content.appear {
            animation: contentAppear 1s ease-out 1s forwards;
        }

        @keyframes contentAppear {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.5);
            }
            100% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .lottery-box {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 255, 255, 0.4);
            width: 280px;
            height: 280px;
            margin: 0 auto 40px;
            border-radius: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 7em;
            animation: float 3s ease-in-out infinite;
            box-shadow: 0 30px 90px rgba(0, 0, 0, 0.4),
                        inset 0 0 40px rgba(255, 255, 255, 0.15);
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-25px);
            }
        }

        .lottery-text {
            color: white;
            font-size: 3.5em;
            font-weight: 800;
            text-shadow: 0 0 30px rgba(255, 255, 255, 0.9),
                         0 0 60px rgba(102, 126, 234, 0.7);
            margin-bottom: 24px;
            animation: glow 2s ease-in-out infinite;
            letter-spacing: -0.02em;
        }

        @keyframes glow {
            0%, 100% {
                text-shadow: 0 0 30px rgba(255, 255, 255, 0.9),
                             0 0 60px rgba(102, 126, 234, 0.7);
            }
            50% {
                text-shadow: 0 0 40px rgba(255, 255, 255, 1),
                             0 0 80px rgba(102, 126, 234, 0.9),
                             0 0 100px rgba(102, 126, 234, 0.7);
            }
        }

        .drumroll-text {
            font-size: 2em;
            color: rgba(255, 255, 255, 0.95);
            font-weight: 400;
            letter-spacing: 0.4em;
            animation: pulse-text 0.5s ease-in-out infinite;
        }

        @keyframes pulse-text {
            0%, 100% { 
                opacity: 0.7;
                transform: scale(1);
            }
            50% { 
                opacity: 1;
                transform: scale(1.08);
            }
        }

        .result-reveal {
            animation: revealResult 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes revealResult {
            0% {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        @media (max-width: 600px) {
            .container {
                padding: 30px 24px;
            }

            h1 {
                font-size: 1.8em;
            }

            .name-inputs {
                grid-template-columns: 1fr;
            }

            .lottery-box {
                width: 200px;
                height: 200px;
                font-size: 5em;
            }

            .lottery-text {
                font-size: 2.5em;
            }

            .drumroll-text {
                font-size: 1.4em;
            }

            .button-container {
                flex-direction: column;
            }

            button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§¹ æƒé™¤å½“ç•ªãã˜å¼•ã</h1>

        <div class="info">
            â„¹ï¸ ç”·æ€§1ã€œ8äººã€å¥³æ€§1ã€œ4äººã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ä½™ã£ãŸäººã¯ãƒ©ãƒ³ãƒ€ãƒ ã§ãƒˆã‚¤ãƒ¬ä»¥å¤–ã®ä½œæ¥­ã‚’2äººä½“åˆ¶ã«ã—ã¾ã™ã€‚åå‰ã¯è‡ªå‹•ä¿å­˜ã•ã‚Œã¾ã™ã€‚
        </div>

        <div class="input-section">
            <div class="gender-group">
                <h3>ğŸ‘¨ ç”·æ€§ãƒ¡ãƒ³ãƒãƒ¼(æœ€å¤§8äºº)</h3>
                <div class="name-inputs">
                    <input type="text" id="male1" placeholder="ç”·æ€§1">
                    <input type="text" id="male2" placeholder="ç”·æ€§2">
                    <input type="text" id="male3" placeholder="ç”·æ€§3">
                    <input type="text" id="male4" placeholder="ç”·æ€§4">
                    <input type="text" id="male5" placeholder="ç”·æ€§5">
                    <input type="text" id="male6" placeholder="ç”·æ€§6">
                    <input type="text" id="male7" placeholder="ç”·æ€§7">
                    <input type="text" id="male8" placeholder="ç”·æ€§8">
                </div>
            </div>

            <div class="gender-group">
                <h3>ğŸ‘© å¥³æ€§ãƒ¡ãƒ³ãƒãƒ¼(æœ€å¤§4äºº)</h3>
                <div class="name-inputs">
                    <input type="text" id="female1" placeholder="å¥³æ€§1">
                    <input type="text" id="female2" placeholder="å¥³æ€§2">
                    <input type="text" id="female3" placeholder="å¥³æ€§3">
                    <input type="text" id="female4" placeholder="å¥³æ€§4">
                </div>
            </div>
        </div>

        <div class="button-container">
            <button id="lotteryButton" onclick="drawLots()">ğŸ² ãã˜ã‚’å¼•ã</button>
            <button onclick="saveNames()" style="background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%); margin-left: 10px;">ğŸ’¾ åå‰ã‚’ä¿å­˜</button>
            <button onclick="clearNames()" style="background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%); margin-left: 10px;">ğŸ—‘ï¸ ã‚¯ãƒªã‚¢</button>
        </div>

        <div id="lottery-animation" class="lottery-animation">
            <div class="stars"></div>
            <div class="center-content">
                <div class="lottery-box">ğŸ</div>
                <div class="lottery-text">æŠ½é¸ä¸­...</div>
                <div class="drumroll-text">â˜… â˜… â˜…</div>
            </div>
        </div>

        <div id="error-message"></div>
        <div id="results" class="results"></div>
    </div>

    <script>
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ä¿å­˜ã•ã‚ŒãŸåå‰ã‚’èª­ã¿è¾¼ã‚€
        window.addEventListener('DOMContentLoaded', () => {
            loadNames();
        });

        // åå‰ã‚’è‡ªå‹•ä¿å­˜
        function autoSaveNames() {
            const names = {
                males: [],
                females: []
            };

            for (let i = 1; i <= 8; i++) {
                names.males.push(document.getElementById(`male${i}`).value.trim());
            }

            for (let i = 1; i <= 4; i++) {
                names.females.push(document.getElementById(`female${i}`).value.trim());
            }

            localStorage.setItem('cleaningLotteryNames', JSON.stringify(names));
        }

        // åå‰ã‚’ä¿å­˜ï¼ˆæ‰‹å‹•ï¼‰
        function saveNames() {
            autoSaveNames();
            
            // ä¿å­˜å®Œäº†ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
            const button = event.target;
            const originalText = button.innerHTML;
            button.innerHTML = 'âœ… ä¿å­˜ã—ã¾ã—ãŸï¼';
            button.disabled = true;
            
            setTimeout(() => {
                button.innerHTML = originalText;
                button.disabled = false;
            }, 2000);
        }

        // ä¿å­˜ã•ã‚ŒãŸåå‰ã‚’èª­ã¿è¾¼ã‚€
        function loadNames() {
            const saved = localStorage.getItem('cleaningLotteryNames');
            if (saved) {
                const names = JSON.parse(saved);
                
                for (let i = 1; i <= 8; i++) {
                    if (names.males[i - 1]) {
                        document.getElementById(`male${i}`).value = names.males[i - 1];
                    }
                }

                for (let i = 1; i <= 4; i++) {
                    if (names.females[i - 1]) {
                        document.getElementById(`female${i}`).value = names.females[i - 1];
                    }
                }
            }
        }

        // åå‰ã‚’ã‚¯ãƒªã‚¢
        function clearNames() {
            if (confirm('å…¥åŠ›ã•ã‚ŒãŸåå‰ã‚’å…¨ã¦ã‚¯ãƒªã‚¢ã—ã¾ã™ã‹ï¼Ÿ')) {
                for (let i = 1; i <= 8; i++) {
                    document.getElementById(`male${i}`).value = '';
                }

                for (let i = 1; i <= 4; i++) {
                    document.getElementById(`female${i}`).value = '';
                }

                localStorage.removeItem('cleaningLotteryNames');
                
                const errorDiv = document.getElementById('error-message');
                errorDiv.innerHTML = '<div class="error" style="background: #d4edda; border-color: #c3e6cb; color: #155724;">âœ… åå‰ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ</div>';
                setTimeout(() => {
                    errorDiv.innerHTML = '';
                }, 2000);
            }
        }

        function drawLots() {
            // å…¥åŠ›å€¤ã®å–å¾—
            const males = [];
            const females = [];

            for (let i = 1; i <= 8; i++) {
                const name = document.getElementById(`male${i}`).value.trim();
                if (name) males.push(name);
            }

            for (let i = 1; i <= 4; i++) {
                const name = document.getElementById(`female${i}`).value.trim();
                if (name) females.push(name);
            }

            // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
            const errorDiv = document.getElementById('error-message');
            if (males.length < 1 || females.length < 1) {
                errorDiv.innerHTML = '<div class="error">âš ï¸ ç”·æ€§ã¨å¥³æ€§ãã‚Œãã‚Œæœ€ä½1äººãšã¤åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</div>';
                document.getElementById('results').classList.remove('show');
                return;
            }

            errorDiv.innerHTML = '';

            // åå‰ã‚’è‡ªå‹•ä¿å­˜
            autoSaveNames();

            // ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
            const button = document.getElementById('lotteryButton');
            button.disabled = true;

            // çµæœã‚’éš ã™
            document.getElementById('results').classList.remove('show');

            // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹
            const animationDiv = document.getElementById('lottery-animation');
            const starsContainer = animationDiv.querySelector('.stars');
            const centerContent = animationDiv.querySelector('.center-content');
            
            // æœ€åˆã¯çœŸã£æš—
            animationDiv.classList.add('active');

            // 0.5ç§’å¾Œï¼šæœ€åˆã®å¤§ããªæµã‚Œæ˜ŸãŒã‚­ãƒ©ãƒ¼ãƒ³ï¼
            setTimeout(() => {
                const bigStar = document.createElement('div');
                bigStar.className = 'big-shooting-star';
                bigStar.style.left = '10%';
                bigStar.style.top = '20%';
                bigStar.style.width = '300px';
                animationDiv.appendChild(bigStar);
                
                setTimeout(() => {
                    bigStar.classList.add('shoot');
                }, 10);
                
                setTimeout(() => bigStar.remove(), 2100);
            }, 500);

            // 1ç§’å¾Œï¼šå®‡å®™ç©ºé–“ãŒç¾ã‚Œã‚‹
            setTimeout(() => {
                animationDiv.classList.add('reveal-space');
            }, 1000);

            // 1.2ç§’å¾Œï¼šæ˜ŸãŒç¾ã‚Œã‚‹
            setTimeout(() => {
                starsContainer.classList.add('appear');
                createStaticStars(starsContainer);
            }, 1200);

            // 1.5ç§’å¾Œï¼šæµã‚Œæ˜ŸãŒæµã‚Œå§‹ã‚ã‚‹
            let starInterval;
            setTimeout(() => {
                starInterval = createShootingStars(animationDiv);
            }, 1500);

            // 2ç§’å¾Œï¼šä¸­å¤®ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒç¾ã‚Œã‚‹
            setTimeout(() => {
                centerContent.classList.add('appear');
            }, 2000);

            // ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³é–‹å§‹ï¼ˆ2.5ç§’å¾Œã‹ã‚‰ï¼‰
            let countdown = 3;
            const lotteryText = centerContent.querySelector('.lottery-text');
            const drumrollText = centerContent.querySelector('.drumroll-text');
            
            setTimeout(() => {
                const countdownInterval = setInterval(() => {
                    countdown--;
                    if (countdown > 0) {
                        lotteryText.textContent = `${countdown}`;
                        drumrollText.textContent = 'âœ¦ '.repeat(countdown * 3);
                    } else {
                        clearInterval(countdownInterval);
                        lotteryText.textContent = 'ç™ºè¡¨ï¼';
                        drumrollText.textContent = 'âœ¨ âœ¨ âœ¨';
                    }
                }, 1000);
            }, 2500);

            // 5.5ç§’å¾Œã«çµæœã‚’è¡¨ç¤º
            setTimeout(() => {
                if (starInterval) clearInterval(starInterval);
                performAssignment(males, females);
                
                // ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆ
                animationDiv.style.animation = 'fadeOut 0.5s ease-out';
                setTimeout(() => {
                    animationDiv.classList.remove('active', 'reveal-space');
                    animationDiv.style.animation = '';
                    starsContainer.classList.remove('appear');
                    centerContent.classList.remove('appear');
                    starsContainer.innerHTML = '';
                }, 500);
                
                button.disabled = false;
            }, 5500);
        }

        function createStaticStars(container) {
            // é™æ­¢ã—ã¦ã„ã‚‹æ˜Ÿã‚’ç”Ÿæˆ
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = (Math.random() * 2 + 1) + 'px';
                star.style.height = star.style.width;
                star.style.animationDelay = Math.random() * 3 + 's';
                container.appendChild(star);
            }
        }

        function createShootingStars(container) {
            const shootingStar = () => {
                const star = document.createElement('div');
                star.className = 'shooting-star';
                star.style.left = Math.random() * 50 + '%';
                star.style.top = Math.random() * 50 + '%';
                star.style.width = (Math.random() * 100 + 100) + 'px';
                container.appendChild(star);

                setTimeout(() => {
                    star.classList.add('shoot');
                }, 10);

                setTimeout(() => star.remove(), 1600);
            };

            // æµã‚Œæ˜Ÿã‚’å®šæœŸçš„ã«ç”Ÿæˆ
            const interval = setInterval(shootingStar, 400);
            
            // æœ€åˆã«æ•°å€‹ç”Ÿæˆ
            for (let i = 0; i < 5; i++) {
                setTimeout(shootingStar, i * 200);
            }

            return interval;
        }

        function performAssignment(males, females) {
            // ã‚·ãƒ£ãƒƒãƒ•ãƒ«é–¢æ•°
            function shuffle(array) {
                const shuffled = [...array];
                for (let i = shuffled.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                }
                return shuffled;
            }

            // ç”·æ€§ã¨å¥³æ€§ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«
            const shuffledMales = shuffle(males);
            const shuffledFemales = shuffle(females);

            // å‰²ã‚Šå½“ã¦
            const assignments = [];
            
            // å¿…é ˆã®å½¹å‰²ï¼ˆãƒˆã‚¤ãƒ¬ã¯æ€§åˆ¥å›ºå®šï¼‰
            let maleIndex = 0;
            let femaleIndex = 0;

            // å¥³å­ãƒˆã‚¤ãƒ¬ - å¥³æ€§1äºº
            assignments.push({
                duty: 'å¥³å­ãƒˆã‚¤ãƒ¬',
                people: [shuffledFemales[femaleIndex++]]
            });

            // ç”·å­ãƒˆã‚¤ãƒ¬ - ç”·æ€§1äºº
            assignments.push({
                duty: 'ç”·å­ãƒˆã‚¤ãƒ¬',
                people: [shuffledMales[maleIndex++]]
            });

            // æ®‹ã‚Šã®äººã‚’æ··ãœã‚‹
            const remainingPeople = [
                ...shuffledMales.slice(maleIndex),
                ...shuffledFemales.slice(femaleIndex)
            ];
            shuffle(remainingPeople);

            // ãƒˆã‚¤ãƒ¬ä»¥å¤–ã®ä½œæ¥­ãƒªã‚¹ãƒˆï¼ˆãƒ€ãƒ–ãƒ«ã«ã§ãã‚‹ä½œæ¥­ï¼‰
            const tasks = [
                { duty: 'ãƒ•ãƒ­ã‚¢', people: [] },
                { duty: 'ä¼šè­°å®¤ç¥æ£š', people: [] },
                { duty: 'å»Šä¸‹ãƒ»ç„é–¢ãƒ»ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ã‚µãƒ¼ãƒãƒ¼', people: [] },
                { duty: 'å¯ç‡ƒã‚´ãƒŸ', people: [] },
                { duty: 'è³‡æºã‚´ãƒŸ', people: [] }
            ];

            // å„ä½œæ¥­ã«æœ€ä½1äººãšã¤å‰²ã‚Šå½“ã¦
            for (let i = 0; i < tasks.length && i < remainingPeople.length; i++) {
                tasks[i].people.push(remainingPeople[i]);
            }

            // ä½™ã£ãŸäººã‚’ãƒ©ãƒ³ãƒ€ãƒ ãªä½œæ¥­ã«è¿½åŠ 
            let extraPeopleIndex = tasks.length;
            while (extraPeopleIndex < remainingPeople.length) {
                // ãƒ©ãƒ³ãƒ€ãƒ ã«ä½œæ¥­ã‚’é¸ã¶
                const randomTaskIndex = Math.floor(Math.random() * tasks.length);
                tasks[randomTaskIndex].people.push(remainingPeople[extraPeopleIndex]);
                extraPeopleIndex++;
            }

            // å¯ç‡ƒã‚´ãƒŸã¯æœ€ä½2äººã«ã™ã‚‹ï¼ˆã‚‚ã—1äººã ã‘ãªã‚‰èª°ã‹ã‚’è¿½åŠ ï¼‰
            const burnable = tasks.find(t => t.duty === 'å¯ç‡ƒã‚´ãƒŸ');
            if (burnable && burnable.people.length === 1) {
                // ä»–ã®1äººã®ä½œæ¥­ã‹ã‚‰èª°ã‹ç§»å‹•
                for (let task of tasks) {
                    if (task.duty !== 'å¯ç‡ƒã‚´ãƒŸ' && task.people.length > 1) {
                        const person = task.people.pop();
                        burnable.people.push(person);
                        break;
                    }
                }
            }

            // çµæœã«è¿½åŠ 
            assignments.push(...tasks);

            // çµæœè¡¨ç¤ºï¼ˆ1ã¤ãšã¤è¡¨ç¤ºï¼‰
            displayResultsWithAnimation(assignments);
        }

        function displayResultsWithAnimation(assignments) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<h2 style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 28px; text-align: center; font-size: 1.8em; font-weight: 800; letter-spacing: -0.02em;">ğŸ“‹ å‰²ã‚Šå½“ã¦çµæœ</h2>';
            resultsDiv.classList.add('show');
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });

            // 1ã¤ãšã¤ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãã§è¡¨ç¤º
            assignments.forEach((assignment, index) => {
                setTimeout(() => {
                    const peopleList = assignment.people.join(' ãƒ» ');
                    const resultItem = document.createElement('div');
                    resultItem.className = 'result-item result-reveal';
                    resultItem.innerHTML = `
                        <div class="duty-name">${assignment.duty}</div>
                        <div class="assigned-person">ğŸ‘¤ ${peopleList}</div>
                    `;
                    resultsDiv.appendChild(resultItem);

                    // ã‚µã‚¦ãƒ³ãƒ‰åŠ¹æœã®ä»£ã‚ã‚Šã«è¦–è¦šåŠ¹æœ
                    resultItem.style.boxShadow = '0 8px 24px rgba(102, 126, 234, 0.3)';
                    setTimeout(() => {
                        resultItem.style.boxShadow = '0 2px 8px rgba(0, 0, 0, 0.04)';
                    }, 500);
                }, index * 400);
            });
        }
    </script>
</body>
</html>
